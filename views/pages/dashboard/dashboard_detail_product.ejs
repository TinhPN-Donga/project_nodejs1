<%- include('includes/header') %>
    <!-- /. NAV SIDE  -->
    <div id="page-wrapper">
        <div id="page-inner">
            <%if(error){%>
                <h1>
                    <%= error%>
                </h1>
                <%}else{%>
                    <div class="row">
                        <div class="col-md-12">
                            <h2>Detail product</h2>
                        </div>
                    </div>
                    <!-- /. ROW  -->
                    <hr />
                    <div class="container text-center">
                        <div class="row align-items-start">
                            <div class="col-md-6">
                                <img src=<%=product.image?
                                    `http://localhost:3000/uploads/${product.image}`: "https://static.thenounproject.com/png/4974686-200.png"
                                    %> alt="" style="width: 70%;">
                            </div>
                            <div class="col-md-6" style="text-align: start;">
                                <b style="font-size: 2rem;">
                                    <%= product.name%>
                                </b>
                                <br>
                                <br>
                                <p>Price: <span>$<%= product.price%></span></p>
                                <br>
                                <p>Description: <%= product.description%>
                                </p>
                                <br>
                                <a class="btn btn-primary" href="/dashboard/products/edit/<%=product._id%>">Edit</a> 
                                <a class="btn btn-danger" onclick="confirmAndDelete('<%= product._id %>')">Delete</a> 
                            </div>
                        </div>
                    </div>
                    <script>
                        function confirmAndDelete(productId) {
                          const isConfirmed = confirm('Do you want to delete this product?');
                          if (isConfirmed) {
                            const deleteUrl = '/dashboard/products/delete/' + productId;
                            fetch(deleteUrl, {
                              method: 'DELETE',
                              headers: {
                                'Content-Type': 'application/json',
                              },
                            })
                            .then(response => {
                              if (response.ok) {
                                window.location.href = '/dashboard/manage-products';
                              } else {
                                alert('Delete product failed!!!');
                              }
                            })
                            .catch(error => {
                                alert('Delete product failed!!!');
                            });
                          }
                        }
                      </script>
                    <%}%>
        </div>
    </div>
    <%- include('includes/footer') %>